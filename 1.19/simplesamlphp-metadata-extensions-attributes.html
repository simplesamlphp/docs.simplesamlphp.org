<!DOCTYPE html>
<html lang="en">
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Language" content="en">
  <meta name="google-site-verification" content="2S8M18BgYs8cLRL6ClTrfW_xGxfFtMZu2b2jhjrNlss">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>SimpleSAMLphp Documentation</title>

  <link rel="stylesheet" href="/res/css/style.css">
  <link rel="stylesheet" href="/res/css/layout.css">
</head>
<body>
<header>
 <div id="header">
  <div class="right">
   <form action="https://www.google.com/cse" method="get" style="margin-top: 2.5rem; margin-right: 2rem">
    <input name="cx" type="hidden" value="004202914224971217557:8ks4jjstupq"/>
    <input name="siteurl" type="hidden" value="www.google.com/cse/home?cx=004202914224971217557:8ks4jjstupq"/>
    <input name="adkw" type="hidden" value="AELymgVJ6Sk-kOvUjbxvgShTLwiFlma2evFuVCh0r8q23vn_4eVnkcdnPfbgMvYUTpJpVlb-KkGAKkbn0i-AlWHsVRR9O0J4CNb6cXFkEKRdjXxsC_NlVD4"/>
    <input name="q" placeholder="Search" type="search" value=""/>
   </form>
  </div>
  <div class="v-center logo-header">
   <div id="logo">
    <a href="https://simplesamlphp.org" style="color: #fff; text-decoration: none">
     <span class="simple">
      Simple
     </span>
     <span class="saml">
      SAML
     </span>
     <span class="simple">
      php
     </span>
    </a>
   </div>
  </div>
 </div>
 <!-- Grey header bar below -->
 <nav>
  <div id="headerbar" style="clear: both">
   <p id="breadcrumb">
    <a href="https://simplesamlphp.org">
     Home
    </a>
    » Documentation
   </p>
   <div class="mtoolbar">
    <div class="menuitem">
     <a href="/docs/1.19/index.html">
      1.19
     </a>
    </div>
    <div class="menuitem">
     <a href="/docs/1.18/index.html">
      1.18
     </a>
    </div>
    <div class="menuitem">
     <a href="/docs/1.17/index.html">
      1.17
     </a>
    </div>
    <div class="menuitem">
     <a href="/docs/1.16/index.html">
      1.16
     </a>
    </div>
    <div class="menuitem first">
     <a href="/docs/devel/index.html">
      devel
     </a>
    </div>
    <div class="menuitem last">
     <a href="/docs/contributed_modules.html">
      Contributed modules
     </a>
    </div>
   </div>
   <br style="height: 0px; clear: both"/>
  </div>
  <!-- /#headerbar -->
 </nav>
 <div id="content">
 </div>
</header><main><h1 id="saml-v20-metadata-attribute-extensions">
 SAML V2.0 Metadata Attribute Extensions
</h1>
<!--
  This file is written in Markdown syntax.
  For more information about how to use the Markdown syntax, read here:
  http://daringfireball.net/projects/markdown/syntax
-->
<!-- {{TOC}} -->
<p>
 This is a reference for the SimpleSAMLphp implementation of the
 <a href="http://docs.oasis-open.org/security/saml/Post2.0/sstc-saml-attribute-ext.pdf">
  SAML
V2.0 Attribute Extensions
 </a>
 defined by OASIS. A common use case is adding entity attributes
to the generated metadata.
</p>
<p>
 For an IdP
 <code>
  metadata/saml20-idp-hosted.php
 </code>
 entries are used to define the
metadata extension items; for an SP they can be added to
 <code>
  config/authsources.php
 </code>
 .
An example of this is:
</p>
<div class="codehilite">
 <pre><span></span><code><span class="w">  </span><span class="cp">&lt;?php</span>
  <span class="nv">$metadata</span><span class="p">[</span><span class="s1">'entity-id-1'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
      <span class="cm">/* ... */</span>
  <span class="s1">'EntityAttributes'</span> <span class="o">=&gt;</span> <span class="p">[</span>
    <span class="s1">'urn:simplesamlphp:v1:simplesamlphp'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'is'</span><span class="p">,</span> <span class="s1">'really'</span><span class="p">,</span> <span class="s1">'cool'</span><span class="p">],</span>
    <span class="s1">'{urn:simplesamlphp:v1}foo'</span>          <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'bar'</span><span class="p">],</span>
  <span class="p">],</span>
      <span class="cm">/* ... */</span>
  <span class="p">];</span>
</code></pre>
</div>
<p>
 The OASIS specification primarily defines how to include arbitrary
 <code>
  Attribute
 </code>
 and
 <code>
  Assertion
 </code>
 elements within the metadata for an entity.
</p>
<p>
 <em>
  Note
 </em>
 : SimpleSAMLphp does not support
 <code>
  Assertion
 </code>
 elements within the
metadata at this time.
</p>
<h2 id="defining-attributes">
 Defining Attributes
</h2>
<p>
 The
 <code>
  EntityAttributes
 </code>
 key is used to define the attributes in the
metadata. Each item in the
 <code>
  EntityAttributes
 </code>
 array defines a new
 <code>
  &lt;Attribute&gt;
 </code>
 item in the metadata. The value for each key must be an
array. Each item in this array produces a separte
 <code>
  &lt;AttributeValue&gt;
 </code>
 element within the
 <code>
  &lt;Attribute&gt;
 </code>
 element.
</p>
<div class="codehilite">
 <pre><span></span><code>  'EntityAttributes' =&gt; [
    'urn:simplesamlphp:v1:simplesamlphp' =&gt; ['is', 'really', 'cool'],
  ],
</code></pre>
</div>
<p>
 This generates:
</p>
<div class="codehilite">
 <pre><span></span><code>    <span class="nt">&lt;saml:Attribute</span> <span class="na">xmlns:saml=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:assertion"</span> <span class="na">Name=</span><span class="s">"urn:simplesamlphp:v1:simplesamlphp"</span> <span class="na">NameFormat=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:attrname-format:uri"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;saml:AttributeValue</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:xs=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span> <span class="na">xsi:type=</span><span class="s">"xs:string"</span><span class="nt">&gt;</span>is<span class="nt">&lt;/saml:AttributeValue&gt;</span>
      <span class="nt">&lt;saml:AttributeValue</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:xs=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span> <span class="na">xsi:type=</span><span class="s">"xs:string"</span><span class="nt">&gt;</span>really<span class="nt">&lt;/saml:AttributeValue&gt;</span>
      <span class="nt">&lt;saml:AttributeValue</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:xs=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span> <span class="na">xsi:type=</span><span class="s">"xs:string"</span><span class="nt">&gt;</span>cool<span class="nt">&lt;/saml:AttributeValue&gt;</span>
    <span class="nt">&lt;/saml:Attribute&gt;</span>
</code></pre>
</div>
<p>
 Each
 <code>
  &lt;Attribute&gt;
 </code>
 element requires a
 <code>
  NameFormat
 </code>
 attribute. This is
specified using curly braces at the beginning of the key name:
</p>
<div class="codehilite">
 <pre><span></span><code>  'EntityAttributes' =&gt; [
    '{urn:simplesamlphp:v1}foo' =&gt; ['bar'],
  ],
</code></pre>
</div>
<p>
 This generates:
</p>
<div class="codehilite">
 <pre><span></span><code>    <span class="nt">&lt;saml:Attribute</span> <span class="na">xmlns:saml=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:assertion"</span> <span class="na">Name=</span><span class="s">"foo"</span> <span class="na">NameFormat=</span><span class="s">"urn:simplesamlphp:v1"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;saml:AttributeValue</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:xs=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span> <span class="na">xsi:type=</span><span class="s">"xs:string"</span><span class="nt">&gt;</span>bar<span class="nt">&lt;/saml:AttributeValue&gt;</span>
    <span class="nt">&lt;/saml:Attribute&gt;</span>
</code></pre>
</div>
<p>
 When the curly braces are omitted, the NameFormat is automatically set
to "urn:oasis:names:tc:SAML:2.0:attrname-format:uri".
</p>
<h2 id="examples">
 Examples
</h2>
<p>
 If given the following configuration...
</p>
<div class="codehilite">
 <pre><span></span><code><span class="w">  </span><span class="o">$</span><span class="nt">metadata</span><span class="cp">[</span><span class="s1">'https://www.example.com/saml/saml2/idp/metadata.php'</span><span class="cp">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="cp">[</span><span class="w"></span>
<span class="w">      </span><span class="s1">'host'</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'www.example.com'</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s1">'certificate'</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'example.com.crt'</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s1">'privatekey'</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'example.com.pem'</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s1">'auth'</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">'example-userpass'</span><span class="p">,</span><span class="w"></span>

<span class="w">  </span><span class="s1">'EntityAttributes'</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">[</span><span class="w"></span>
<span class="w">    </span><span class="s1">'urn:simplesamlphp:v1:simplesamlphp'</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">[</span><span class="s1">'is'</span><span class="p">,</span><span class="w"> </span><span class="s1">'really'</span><span class="p">,</span><span class="w"> </span><span class="s1">'cool'</span><span class="cp">]</span><span class="o">,</span><span class="w"></span>
<span class="w">    </span><span class="s1">'{urn:simplesamlphp:v1}foo'</span><span class="w">          </span><span class="o">=&gt;</span><span class="w"> </span><span class="cp">[</span><span class="s1">'bar'</span><span class="cp">]</span><span class="o">,</span><span class="w"></span>
<span class="w">  </span><span class="o">],</span><span class="w"></span>
<span class="o">];</span><span class="w"></span>
</code></pre>
</div>
<p>
 ... will generate the following XML metadata:
</p>
<div class="codehilite">
 <pre><span></span><code><?xml version="1.0"?>


<span class="nt">&lt;md:EntityDescriptor</span> <span class="na">xmlns:md=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:metadata"</span> <span class="na">xmlns:mdattr=</span><span class="s">"urn:oasis:names:tc:SAML:metadata:attribute"</span> <span class="na">xmlns:saml=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:assertion"</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:mdui=</span><span class="s">"urn:oasis:names:tc:SAML:metadata:ui"</span> <span class="na">xmlns:ds=</span><span class="s">"http://www.w3.org/2000/09/xmldsig#"</span> <span class="na">entityID=</span><span class="s">"https://www.example.com/saml/saml2/idp/metadata.php"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;md:Extensions&gt;</span>
  <span class="nt">&lt;mdattr:EntityAttributes</span> <span class="na">xmlns:mdattr=</span><span class="s">"urn:oasis:names:tc:SAML:metadata:attribute"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;saml:Attribute</span> <span class="na">xmlns:saml=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:assertion"</span> <span class="na">Name=</span><span class="s">"urn:simplesamlphp:v1:simplesamlphp"</span> <span class="na">NameFormat=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:attrname-format:uri"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;saml:AttributeValue</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:xs=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span> <span class="na">xsi:type=</span><span class="s">"xs:string"</span><span class="nt">&gt;</span>is<span class="nt">&lt;/saml:AttributeValue&gt;</span>
    <span class="nt">&lt;saml:AttributeValue</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:xs=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span> <span class="na">xsi:type=</span><span class="s">"xs:string"</span><span class="nt">&gt;</span>really<span class="nt">&lt;/saml:AttributeValue&gt;</span>
    <span class="nt">&lt;saml:AttributeValue</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:xs=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span> <span class="na">xsi:type=</span><span class="s">"xs:string"</span><span class="nt">&gt;</span>cool<span class="nt">&lt;/saml:AttributeValue&gt;</span>
    <span class="nt">&lt;/saml:Attribute&gt;</span>
    <span class="nt">&lt;saml:Attribute</span> <span class="na">xmlns:saml=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:assertion"</span> <span class="na">Name=</span><span class="s">"foo"</span> <span class="na">NameFormat=</span><span class="s">"urn:simplesamlphp:v1"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;saml:AttributeValue</span> <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:xs=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span> <span class="na">xsi:type=</span><span class="s">"xs:string"</span><span class="nt">&gt;</span>bar<span class="nt">&lt;/saml:AttributeValue&gt;</span>
    <span class="nt">&lt;/saml:Attribute&gt;</span>
  <span class="nt">&lt;/mdattr:EntityAttributes&gt;</span>
  <span class="nt">&lt;/md:Extensions&gt;</span>
  <span class="nt">&lt;md:IDPSSODescriptor</span> <span class="na">protocolSupportEnumeration=</span><span class="s">"urn:oasis:names:tc:SAML:2.0:protocol"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;md:KeyDescriptor</span> <span class="na">use=</span><span class="s">"signing"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ds:KeyInfo</span> <span class="na">xmlns:ds=</span><span class="s">"http://www.w3.org/2000/09/xmldsig#"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;ds:X509Data&gt;</span>
          ...
</code></pre>
</div>
<p>
 An example configuration to declare Géant Data Protection Code of Conduct
entity category support for a service provider in
 <code>
  authsources.php
 </code>
 :
</p>
<div class="codehilite">
 <pre><span></span><code>  'saml:SP' =&gt; [
      ...
      'EntityAttributes' =&gt; [
          'http://macedir.org/entity-category' =&gt; [
              'http://www.geant.net/uri/dataprotection-code-of-conduct/v1'
          ]
      ],
      'UIInfo' =&gt;[
              'DisplayName' =&gt; [
                  'en' =&gt; 'English name',
                  'es' =&gt; 'Nombre en Español',
              ],
              'Description' =&gt; [
                  'en' =&gt; 'English description',
                  'es' =&gt; 'Descripción en Español',
              ],
              'InformationURL' =&gt; [
                  'en' =&gt; 'http://example.com/info/en',
                  'es' =&gt; 'http://example.com/info/es',
              ],
              'PrivacyStatementURL' =&gt; [
                  'en' =&gt; 'http://example.com/privacy/en',
                  'es' =&gt; 'http://example.com/privacy/es',
              ],
      ]
  ],
</code></pre>
</div></main></body>
</html>
