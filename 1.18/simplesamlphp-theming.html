<!DOCTYPE html>
<html lang="en">
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Language" content="en">
  <meta name="google-site-verification" content="2S8M18BgYs8cLRL6ClTrfW_xGxfFtMZu2b2jhjrNlss">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>SimpleSAMLphp Documentation</title>

  <link rel="stylesheet" href="/res/css/style.css">
  <link rel="stylesheet" href="/res/css/layout.css">
</head>
<body>
<header>
 <div id="header">
  <div class="right">
   <form action="https://www.google.com/cse" method="get" style="margin-top: 2.5rem; margin-right: 2rem">
    <input name="cx" type="hidden" value="004202914224971217557:8ks4jjstupq"/>
    <input name="siteurl" type="hidden" value="www.google.com/cse/home?cx=004202914224971217557:8ks4jjstupq"/>
    <input name="adkw" type="hidden" value="AELymgVJ6Sk-kOvUjbxvgShTLwiFlma2evFuVCh0r8q23vn_4eVnkcdnPfbgMvYUTpJpVlb-KkGAKkbn0i-AlWHsVRR9O0J4CNb6cXFkEKRdjXxsC_NlVD4"/>
    <input name="q" placeholder="Search" type="search" value=""/>
   </form>
  </div>
  <div class="v-center logo-header">
   <div id="logo">
    <a href="https://simplesamlphp.org" style="color: #fff; text-decoration: none">
     <span class="simple">
      Simple
     </span>
     <span class="saml">
      SAML
     </span>
     <span class="simple">
      php
     </span>
    </a>
   </div>
  </div>
 </div>
 <!-- Grey header bar below -->
 <nav>
  <div id="headerbar" style="clear: both">
   <p id="breadcrumb">
    <a href="https://simplesamlphp.org">
     Home
    </a>
    » Documentation
   </p>
   <div class="mtoolbar">
    <div class="menuitem first">
     <a href="/docs/latest/index.html">
      latest
     </a>
    </div>
    <div class="menuitem">
     <a href="/docs/1.19/index.html">
      1.19
     </a>
    </div>
    <div class="menuitem">
     <a href="/docs/1.18/index.html">
      1.18
     </a>
    </div>
    <div class="menuitem">
     <a href="/docs/1.17/index.html">
      1.17
     </a>
    </div>
    <div class="menuitem">
     <a href="/docs/1.16/index.html">
      1.16
     </a>
    </div>
    <div class="menuitem last">
     <a href="/docs/contributed_modules.html">
      Contributed modules
     </a>
    </div>
   </div>
   <br style="height: 0px; clear: both"/>
  </div>
  <!-- /#headerbar -->
 </nav>
 <div id="content">
 </div>
</header><h1 id="theming-the-user-interface-in-simplesamlphp">
 Theming the user interface in SimpleSAMLphp
</h1>
<!--
  This file is written in Markdown syntax.
  For more information about how to use the Markdown syntax, read here:
  http://daringfireball.net/projects/markdown/syntax
-->
<!-- {{TOC}} -->
<p>
 In SimpleSAMLphp every part that needs to interact with the user by using a web page, uses templates to present the XHTML. SimpleSAMLphp comes with a default set of templates that presents a anonymous look.
</p>
<p>
 You may create your own theme, where you add one or more template files that will override the default ones. This document explains how to achieve that.
</p>
<h2 id="how-themes-work">
 How themes work
</h2>
<p>
 If you want to customize the UI, the right way to do that is to create a new
 <strong>
  theme
 </strong>
 . A theme is a set of templates that can be configured to override the default templates.
</p>
<h3 id="configuring-which-theme-to-use">
 Configuring which theme to use
</h3>
<p>
 In
 <code>
  config.php
 </code>
 there is a configuration option that controls theming. Here is an example:
</p>
<div class="codehilite">
 <pre><span></span><code>'theme.use'     =&gt; 'fancymodule:fancytheme',
</code></pre>
</div>
<p>
 The
 <code>
  theme.use
 </code>
 parameter points to which theme that will be used. If some functionality in SimpleSAMLphp needs to present UI in example with the
 <code>
  logout.php
 </code>
 template, it will first look for
 <code>
  logout.php
 </code>
 in the
 <code>
  theme.use
 </code>
 theme, and if not found it will all fallback to look for the base templates.
</p>
<p>
 All required templates SHOULD be available as a base in the
 <code>
  templates
 </code>
 folder, and you SHOULD never change the base templates. To customize UI, add a new theme within a module that overrides the base templates, instead of modifying it.
</p>
<h3 id="templates-that-include-other-files">
 Templates that include other files
</h3>
<p>
 A template file may
 <em>
  include
 </em>
 other files. For example all the default templates will include a header and footer: the
 <code>
  login.php
 </code>
 template will first include
 <code>
  includes/header.php
 </code>
 then present the login page, and then include
 <code>
  includes/footer.php
 </code>
 .
</p>
<p>
 SimpleSAMLphp allows themes to override the included templates files only, if needed. That means you can create a new theme
 <code>
  fancytheme
 </code>
 that includes only a header and footer. The header file refers to the CSS files, which means that a simple way of making a new look on SimpleSAMLphp is to create a new theme, and copy the existing header, but point to your own CSS instead of the default CSS.
</p>
<h2 id="creating-your-first-theme">
 Creating your first theme
</h2>
<p>
 The first thing you need to do is having a SimpleSAMLphp module to place your theme in. If you do not have a module already, create a new one:
</p>
<div class="codehilite">
 <pre><span></span><code>cd modules
mkdir mymodule
cd mymodule
touch default-enable
</code></pre>
</div>
<p>
 Then within this module, you can create a new theme named
 <code>
  fancytheme
 </code>
 .
</p>
<div class="codehilite">
 <pre><span></span><code>cd modules/mymodule
mkdir -p themes/fancytheme
</code></pre>
</div>
<p>
 Now, configure SimpleSAMLphp to use your new theme in
 <code>
  config.php
 </code>
 :
</p>
<div class="codehilite">
 <pre><span></span><code>'theme.use'     =&gt; 'mymodule:fancytheme',
</code></pre>
</div>
<p>
 Next, we create
 <code>
  themes/fancytheme/default/includes
 </code>
 , and copy the header file from the base theme:
</p>
<div class="codehilite">
 <pre><span></span><code>cp templates/includes/header.php modules/mymodule/themes/fancytheme/default/includes/
</code></pre>
</div>
<p>
 In the
 <code>
  modules/mymodule/themes/fancytheme/default/includes/header.php
 </code>
 type in something and go to the SimpleSAMLphp front page to see that your new theme is in use.
</p>
<p>
 A good start is to modify the reference to the default CSS:
</p>
<div class="codehilite">
 <pre><span></span><code><span class="o">&lt;</span><span class="nx">link</span> <span class="nx">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"text/css"</span> <span class="nx">href</span><span class="o">=</span><span class="s2">"/</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="s1">'baseurlpath'</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="s2">resources/default.css"</span> <span class="o">/&gt;</span>
</code></pre>
</div>
<p>
 to in example:
</p>
<div class="codehilite">
 <pre><span></span><code><span class="o">&lt;</span><span class="nx">link</span> <span class="nx">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"text/css"</span> <span class="nx">href</span><span class="o">=</span><span class="s2">"/</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">[</span><span class="s1">'baseurlpath'</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="s2">resources/fancytheme/default.css"</span> <span class="o">/&gt;</span>
</code></pre>
</div>
<h2 id="examples">
 Examples
</h2>
<p>
 To override the frontpage body, add the file:
</p>
<div class="codehilite">
 <pre><span></span><code><span class="n">modules</span><span class="o">/</span><span class="n">mymodule</span><span class="o">/</span><span class="n">themes</span><span class="o">/</span><span class="n">fancytheme</span><span class="o">/</span><span class="k">default</span><span class="o">/</span><span class="n">frontpage</span>.<span class="n">php</span>
</code></pre>
</div>
<p>
 In the path above
 <code>
  default
 </code>
 means that the frontpage template is not part of any modules. If you are replacing a template that is part of a module, then use the module name instead of
 <code>
  default
 </code>
 .
</p>
<p>
 For example, to override the
 <code>
  preprodwarning
 </code>
 template, (the file is located in
 <code>
  modules/preprodwarning/templates/warning.php
 </code>
 ), you need to add a new file:
</p>
<div class="codehilite">
 <pre><span></span><code><span class="n">modules</span><span class="o">/</span><span class="n">mymodule</span><span class="o">/</span><span class="n">themes</span><span class="o">/</span><span class="n">fancytheme</span><span class="o">/</span><span class="n">preprodwarning</span><span class="o">/</span><span class="n">warning</span>.<span class="n">php</span>
</code></pre>
</div>
<p>
 Say in a module
 <code>
  foomodule
 </code>
 , some code requests to present the
 <code>
  bar.php
 </code>
 template, SimpleSAMLphp will:
</p>
<ol>
 <li>
  first look in your theme for a replacement:
  <code>
   modules/mymodule/themes/fancytheme/foomodule/bar.php
  </code>
  .
 </li>
 <li>
  If not found, it will use the base template of that module:
  <code>
   modules/foomodule/templates/bar.php
  </code>
 </li>
</ol>
<h2 id="adding-resource-files">
 Adding resource files
</h2>
<p>
 You can put resource files within the www folder of your module, to make your module completely independent with included css, icons etc.
</p>
<div class="codehilite">
 <pre><span></span><code><span class="n">modules</span>
└───<span class="n">mymodule</span>
    └───<span class="n">lib</span>
    └───<span class="n">themes</span>
    └───<span class="n">www</span>
        └───<span class="n">logo</span>.<span class="n">png</span>
        └───<span class="n">style</span>.<span class="n">css</span>
</code></pre>
</div>
<p>
 Reference these resources in your custom PHP templates under
 <code>
  themes/fancytheme
 </code>
 by using a generator for the URL:
</p>
<div class="codehilite">
 <pre><span></span><code><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">SimpleSAML\Module</span><span class="o">::</span><span class="na">getModuleURL</span><span class="p">(</span><span class="s1">'mymodule/logo.png'</span><span class="p">);</span> <span class="cp">?&gt;</span>
</code></pre>
</div>
<p>
 Example for a custom CSS stylesheet file:
</p>
<div class="codehilite">
 <pre><span></span><code><span class="o">&lt;</span><span class="nx">link</span> <span class="nx">rel</span><span class="o">=</span><span class="s2">"stylesheet"</span> <span class="nx">href</span><span class="o">=</span><span class="s2">"</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">SimpleSAML\Module</span><span class="o">::</span><span class="na">getModuleURL</span><span class="p">(</span><span class="s1">'mymodule/style.css'</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="s2">"</span><span class="o">&gt;</span>
</code></pre>
</div>
<h2 id="migrating-to-twig-templates">
 Migrating to Twig templates
</h2>
<p>
 In version 1.15, a new templating system based on
 <a href="https://twig.symfony.com/">
  Twig
 </a>
 was introduced. As modules migrate, it will become necessary for themes to include both the old templating style described above and new Twig-based templates.
</p>
<p>
 Twig works by extending a base template, which can itself include other partial templates. Some of the content of the old
 <code>
  includes/header.php
 </code>
 template is now located in a separate
 <code>
  _header.twig
 </code>
 file. This can be customized by copying it from the base template:
</p>
<div class="codehilite">
 <pre><span></span><code>cp templates/_header.twig modules/mymodule/themes/fancytheme/default/
</code></pre>
</div>
<p>
 If you need to make more extensive customizations to the base template, you should copy it from the base theme:
</p>
<div class="codehilite">
 <pre><span></span><code>cp templates/base.twig modules/mymodule/themes/fancytheme/default/
</code></pre>
</div>
<p>
 Any references to
 <code>
  $this-&gt;data['baseurlpath']
 </code>
 in old-style templates can be replaced with
 <code>
  {{baseurlpath}}
 </code>
 in Twig templates. Likewise, references to
 <code>
  \SimpleSAML\Module::getModuleURL()
 </code>
 can be replaced with
 <code>
  {{baseurlpath}}module.php/mymodule/...
 </code>
</p>
<p>
 Within templates each module is defined as a separate namespace matching the module name. This allows one template to reference templates from other modules using Twig's
 <code>
  @namespace_name/template_path
 </code>
 notation. For instance, a template in
 <code>
  mymodule
 </code>
 can include the widget template from the
 <code>
  yourmodule
 </code>
 module using the notation
 <code>
  @yourmodule/widget.twig
 </code>
 . A special namespace,
 <code>
  __parent__
 </code>
 , exists to allow theme developers to more easily extend a module's stock template.
</p>
<p>
 Even more advanced changes can be made by defining a theme controller in
 <code>
  config.php
 </code>
 :
</p>
<div class="codehilite">
 <pre><span></span><code>  'theme.controller' =&gt; '\SimpleSAML\Module\mymodule\FancyThemeController',
</code></pre>
</div>
<p>
 This requires you to implement
 <code>
  \SimpleSAML\XHTML\TemplateControllerInterface.php
 </code>
 in your module's
 <code>
  lib
 </code>
 -directory.
The class can then modify the Twig Environment and the variables passed to the theme's templates. In short, this allows you to set additional global variables and to write your own Twig filters and functions.
</p>
<p>
 See the
 <a href="https://twig.symfony.com/doc/1.x/templates.html">
  Twig documentation
 </a>
 for more information on using variables and expressions in Twig templates, and the SimpleSAMLphp wiki for
 <a href="https://github.com/simplesamlphp/simplesamlphp/wiki/Twig-conventions">
  our conventions
 </a>
 .
</p>
<p>
 The wiki also includes some information on
 <a href="https://github.com/simplesamlphp/simplesamlphp/wiki/Migrating-translation-in-Twig">
  migrating translations
 </a>
 and
 <a href="https://github.com/simplesamlphp/simplesamlphp/wiki/Twig:-Migrating-templates">
  migrating templates
 </a>
 .
</p></body>
</html>
